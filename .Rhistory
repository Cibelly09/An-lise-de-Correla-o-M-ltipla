df_ACM %>%
rownames_to_column() %>%
rename(Categoria = 1) %>%
ggplot(aes(x = CS1, y = CS2, label = Categoria, color = Variável)) +
geom_point() +
geom_label_repel() +
geom_vline(aes(xintercept = 0), linetype = "longdash", color = "grey48") +
geom_hline(aes(yintercept = 0), linetype = "longdash", color = "grey48") +
labs(x = paste("Dimensão 1:", paste0(round(perc_variancia[1], 2), "%")),
y = paste("Dimensão 2:", paste0(round(perc_variancia[2], 2), "%"))) +
theme_bw()
df_ACM <- data.frame(ACM$c1, Variável = rep(names(quant_categorias),
quant_categorias))
# Vamos gerar a ACM
ACM <- dudi.acm(dados_acm, scannf = FALSE)
# Analisando as variâncias de cada dimensão (tirando os autovalores)
perc_variancia <- (ACM$eig / sum(ACM$eig)) * 100
paste0(round(perc_variancia,2),"%")
# Quantidade de categorias por variável
quant_categorias <- apply(dados_acm,
MARGIN =  2,
FUN = function(x) nlevels(as.factor(x)))
df_ACM <- data.frame(ACM$c1, Variável = rep(names(quant_categorias),
quant_categorias))
# Plotando o mapa perceptual
df_ACM %>%
rownames_to_column() %>%
rename(Categoria = 1) %>%
ggplot(aes(x = CS1, y = CS2, label = Categoria, color = Variável)) +
geom_point() +
geom_label_repel() +
geom_vline(aes(xintercept = 0), linetype = "longdash", color = "grey48") +
geom_hline(aes(yintercept = 0), linetype = "longdash", color = "grey48") +
labs(x = paste("Dimensão 1:", paste0(round(perc_variancia[1], 2), "%")),
y = paste("Dimensão 2:", paste0(round(perc_variancia[2], 2), "%"))) +
theme_bw()
# A função para a criação da ACM pede que sejam utilizados "fatores"
dados_acm <- as.data.frame(unclass(dados_acm), stringsAsFactors=TRUE)
# Tabelas de contingência (todas apresentam associação com alguma variável?)
sjt.xtab(var.row = dados_acm $DS_TIPO_DEFICIENCIA,
var.col = dados_acm $DS_GENERO,
show.exp = TRUE,
show.row.prc = TRUE,
show.col.prc = TRUE,
encoding = "UTF-8")
sjt.xtab(var.row = dados_acm $DS_TIPO_DEFICIENCIA,
var.col = dados_acm $DS_FAIXA_ETARIA,
show.exp = TRUE,
show.row.prc = TRUE,
show.col.prc = TRUE,
encoding = "UTF-8")
sjt.xtab(var.row = dados_acm $DS_TIPO_DEFICIENCIA,
var.col = dados_acm $DS_RACA_COR,
show.exp = TRUE,
show.row.prc = TRUE,
show.col.prc = TRUE,
encoding = "UTF-8")
sjt.xtab(var.row = dados_acm $DS_TIPO_DEFICIENCIA,
var.col = dados_acm $DS_GRAU_ESCOLARIDADE,
show.exp = TRUE,
show.row.prc = TRUE,
show.col.prc = TRUE,
encoding = "UTF-8")
sjt.xtab(var.row = dados_acm $DS_TIPO_DEFICIENCIA,
var.col = dados_acm $DS_ESTADO_CIVIL,
show.exp = TRUE,
show.row.prc = TRUE,
show.col.prc = TRUE,
encoding = "UTF-8")
sjt.xtab(var.row = dados_acm $DS_TIPO_DEFICIENCIA,
var.col = dados_acm $SG_UF,
show.exp = TRUE,
show.row.prc = TRUE,
show.col.prc = TRUE,
encoding = "UTF-8")
sjt.xtab(var.row = dados_acm $DS_TIPO_DEFICIENCIA,
var.col = dados_acm $REGIAO,
show.exp = TRUE,
show.row.prc = TRUE,
show.col.prc = TRUE,
encoding = "UTF-8")
# Vamos gerar a ACM
ACM <- dudi.acm(dados_acm, scannf = FALSE)
# Analisando as variâncias de cada dimensão (tirando os autovalores)
perc_variancia <- (ACM$eig / sum(ACM$eig)) * 100
paste0(round(perc_variancia,2),"%")
# Quantidade de categorias por variável
quant_categorias <- apply(dados_acm,
MARGIN =  2,
FUN = function(x) nlevels(as.factor(x)))
df_ACM <- data.frame(ACM$c1, Variável = rep(names(quant_categorias),
quant_categorias))
# Plotando o mapa perceptual
df_ACM %>%
rownames_to_column() %>%
rename(Categoria = 1) %>%
ggplot(aes(x = CS1, y = CS2, label = Categoria, color = Variável)) +
geom_point() +
geom_label_repel() +
geom_vline(aes(xintercept = 0), linetype = "longdash", color = "grey48") +
geom_hline(aes(yintercept = 0), linetype = "longdash", color = "grey48") +
labs(x = paste("Dimensão 1:", paste0(round(perc_variancia[1], 2), "%")),
y = paste("Dimensão 2:", paste0(round(perc_variancia[2], 2), "%"))) +
theme_bw()
grafico_acm <- ggplot(df_ACM, aes(x = CS1, y = CS2, label = rownames(df_ACM), color = Variável)) +
geom_point() +
geom_label_repel(size = 3, show.legend = FALSE) +
geom_vline(xintercept = 0, linetype = "longdash", color = "grey48") +
geom_hline(yintercept = 0, linetype = "longdash", color = "grey48") +
theme_bw() +
labs(
title = "Mapa Perceptual - Análise de Correspondência Múltipla",
x = paste("Dimensão 1:", round(perc_variancia[1], 2), "%"),
y = paste("Dimensão 2:", round(perc_variancia[2], 2), "%")
)
print(grafico_acm)
install.packages("ggplot2")
library('ggplot2')
df_ACM <- data.frame(ACM$c1, Variável = rep(names(quant_categorias),
quant_categorias))
# Plotando o mapa perceptual
df_ACM %>%
rownames_to_column() %>%
rename(Categoria = 1) %>%
ggplot(aes(x = CS1, y = CS2, label = Categoria, color = Variável)) +
geom_point() +
geom_label_repel() +
geom_vline(aes(xintercept = 0), linetype = "longdash", color = "grey48") +
geom_hline(aes(yintercept = 0), linetype = "longdash", color = "grey48") +
labs(x = paste("Dimensão 1:", paste0(round(perc_variancia[1], 2), "%")),
y = paste("Dimensão 2:", paste0(round(perc_variancia[2], 2), "%"))) +
theme_bw()
# Vamos gerar a ACM
ACM <- dudi.acm(dados_acm, scannf = FALSE)
# A função para a criação da ACM pede que sejam utilizados "fatores"
dados_acm <- as.data.frame(unclass(dados_acm), stringsAsFactors=TRUE)
# Tabelas de contingência (todas apresentam associação com alguma variável?)
sjt.xtab(var.row = dados_acm $DS_TIPO_DEFICIENCIA,
var.col = dados_acm $DS_GENERO,
show.exp = TRUE,
show.row.prc = TRUE,
show.col.prc = TRUE,
encoding = "UTF-8")
# --- 24/08
getwd()
dados_acm<- read.csv("perfil_eleitor_red.csv", sep = ",", header = TRUE, stringsAsFactors = TRUE)
# Mostra as primeiras linhas do data frame
head(dados_acm)
# Mostra a estrutura do data frame
str(dados_acm)
# Padroniza os nomes (tudo maiúsculo)
names(dados_acm) <- toupper(names(dados_acm))
# Remove linhas com NA (caso existam)
dados_acm <- na.omit(dados_acm)
# Instalação e carregamento dos pacotes utilizados
pacotes <- c("plotly",
"tidyverse",
"ggrepel",
"knitr", "kableExtra",
"sjPlot",
"FactoMineR",
"amap",
"ade4",
"readxl")
install.packages("ggplot2")
install.packages("ggplot2")
library('ggplot2')
# Carregando todos
if(sum(as.numeric(!pacotes %in% installed.packages())) != 0){
instalador <- pacotes[!pacotes %in% installed.packages()]
for(i in 1:length(instalador)) {
install.packages(instalador, dependencies = T)
break()}
sapply(pacotes, require, character = T)
} else {
sapply(pacotes, require, character = T)
}
# A função para a criação da ACM pede que sejam utilizados "fatores"
dados_acm <- as.data.frame(unclass(dados_acm), stringsAsFactors=TRUE)
# Tabelas de contingência (todas apresentam associação com alguma variável?)
sjt.xtab(var.row = dados_acm $DS_TIPO_DEFICIENCIA,
var.col = dados_acm $DS_GENERO,
show.exp = TRUE,
show.row.prc = TRUE,
show.col.prc = TRUE,
encoding = "UTF-8")
sjt.xtab(var.row = dados_acm $DS_TIPO_DEFICIENCIA,
var.col = dados_acm $DS_FAIXA_ETARIA,
show.exp = TRUE,
show.row.prc = TRUE,
show.col.prc = TRUE,
encoding = "UTF-8")
sjt.xtab(var.row = dados_acm $DS_TIPO_DEFICIENCIA,
var.col = dados_acm $DS_RACA_COR,
show.exp = TRUE,
show.row.prc = TRUE,
show.col.prc = TRUE,
encoding = "UTF-8")
sjt.xtab(var.row = dados_acm $DS_TIPO_DEFICIENCIA,
var.col = dados_acm $DS_GRAU_ESCOLARIDADE,
show.exp = TRUE,
show.row.prc = TRUE,
show.col.prc = TRUE,
encoding = "UTF-8")
sjt.xtab(var.row = dados_acm $DS_TIPO_DEFICIENCIA,
var.col = dados_acm $DS_ESTADO_CIVIL,
show.exp = TRUE,
show.row.prc = TRUE,
show.col.prc = TRUE,
encoding = "UTF-8")
sjt.xtab(var.row = dados_acm $DS_TIPO_DEFICIENCIA,
var.col = dados_acm $SG_UF,
show.exp = TRUE,
show.row.prc = TRUE,
show.col.prc = TRUE,
encoding = "UTF-8")
sjt.xtab(var.row = dados_acm $DS_TIPO_DEFICIENCIA,
var.col = dados_acm $REGIAO,
show.exp = TRUE,
show.row.prc = TRUE,
show.col.prc = TRUE,
encoding = "UTF-8")
# Vamos gerar a ACM
ACM <- dudi.acm(dados_acm, scannf = FALSE)
# Analisando as variâncias de cada dimensão (tirando os autovalores)
perc_variancia <- (ACM$eig / sum(ACM$eig)) * 100
paste0(round(perc_variancia,2),"%")
# Quantidade de categorias por variável
quant_categorias <- apply(dados_acm,
MARGIN =  2,
FUN = function(x) nlevels(as.factor(x)))
df_ACM <- data.frame(ACM$c1, Variável = rep(names(quant_categorias),
quant_categorias))
# Plotando o mapa perceptual
df_ACM %>%
rownames_to_column() %>%
rename(Categoria = 1) %>%
ggplot(aes(x = CS1, y = CS2, label = Categoria, color = Variável)) +
geom_point() +
geom_label_repel() +
geom_vline(aes(xintercept = 0), linetype = "longdash", color = "grey48") +
geom_hline(aes(yintercept = 0), linetype = "longdash", color = "grey48") +
labs(x = paste("Dimensão 1:", paste0(round(perc_variancia[1], 2), "%")),
y = paste("Dimensão 2:", paste0(round(perc_variancia[2], 2), "%"))) +
theme_bw()
grafico_acm <- ggplot(df_ACM, aes(x = CS1, y = CS2, label = rownames(df_ACM), color = Variável)) +
geom_point() +
geom_label_repel(size = 3, show.legend = FALSE) +
geom_vline(xintercept = 0, linetype = "longdash", color = "grey48") +
geom_hline(yintercept = 0, linetype = "longdash", color = "grey48") +
theme_bw() +
labs(
title = "Mapa Perceptual - Análise de Correspondência Múltipla",
x = paste("Dimensão 1:", round(perc_variancia[1], 2), "%"),
y = paste("Dimensão 2:", round(perc_variancia[2], 2), "%")
)
print(grafico_acm)
library(ggplot2)
library(ggrepel)
# A função para a criação da ACM pede que sejam utilizados "fatores"
dados_acm <- as.data.frame(unclass(dados_acm), stringsAsFactors=TRUE)
# Tabelas de contingência (todas apresentam associação com alguma variável?)
sjt.xtab(var.row = dados_acm $DS_TIPO_DEFICIENCIA,
var.col = dados_acm $DS_GENERO,
show.exp = TRUE,
show.row.prc = TRUE,
show.col.prc = TRUE,
encoding = "UTF-8")
sjt.xtab(var.row = dados_acm $DS_TIPO_DEFICIENCIA,
var.col = dados_acm $DS_FAIXA_ETARIA,
show.exp = TRUE,
show.row.prc = TRUE,
show.col.prc = TRUE,
encoding = "UTF-8")
sjt.xtab(var.row = dados_acm $DS_TIPO_DEFICIENCIA,
var.col = dados_acm $DS_RACA_COR,
show.exp = TRUE,
show.row.prc = TRUE,
show.col.prc = TRUE,
encoding = "UTF-8")
sjt.xtab(var.row = dados_acm $DS_TIPO_DEFICIENCIA,
var.col = dados_acm $DS_GRAU_ESCOLARIDADE,
show.exp = TRUE,
show.row.prc = TRUE,
show.col.prc = TRUE,
encoding = "UTF-8")
sjt.xtab(var.row = dados_acm $DS_TIPO_DEFICIENCIA,
var.col = dados_acm $DS_ESTADO_CIVIL,
show.exp = TRUE,
show.row.prc = TRUE,
show.col.prc = TRUE,
encoding = "UTF-8")
sjt.xtab(var.row = dados_acm $DS_TIPO_DEFICIENCIA,
var.col = dados_acm $SG_UF,
show.exp = TRUE,
show.row.prc = TRUE,
show.col.prc = TRUE,
encoding = "UTF-8")
sjt.xtab(var.row = dados_acm $DS_TIPO_DEFICIENCIA,
var.col = dados_acm $REGIAO,
show.exp = TRUE,
show.row.prc = TRUE,
show.col.prc = TRUE,
encoding = "UTF-8")
# Vamos gerar a ACM
ACM <- dudi.acm(dados_acm, scannf = FALSE)
# Analisando as variâncias de cada dimensão (tirando os autovalores)
perc_variancia <- (ACM$eig / sum(ACM$eig)) * 100
paste0(round(perc_variancia,2),"%")
# Quantidade de categorias por variável
quant_categorias <- apply(dados_acm,
MARGIN =  2,
FUN = function(x) nlevels(as.factor(x)))
df_ACM <- data.frame(ACM$c1, Variável = rep(names(quant_categorias),
quant_categorias))
# Plotando o mapa perceptual
df_ACM %>%
rownames_to_column() %>%
rename(Categoria = 1) %>%
ggplot(aes(x = CS1, y = CS2, label = Categoria, color = Variável)) +
geom_point() +
geom_label_repel() +
geom_vline(aes(xintercept = 0), linetype = "longdash", color = "grey48") +
geom_hline(aes(yintercept = 0), linetype = "longdash", color = "grey48") +
labs(x = paste("Dimensão 1:", paste0(round(perc_variancia[1], 2), "%")),
y = paste("Dimensão 2:", paste0(round(perc_variancia[2], 2), "%"))) +
theme_bw()
dev.off()  # fecha qualquer dispositivo gráfico aberto
graphics.off()  # limpa todos
windows(width = 10, height = 8)  # se estiver no Windows
print(grafico_acm)
ggsave("mapa_acm_perfil.png", grafico_acm, width = 10, height = 8, dpi = 300)
colnames(df_ACM)
# Análise da variabilidade para determinar o número de clusters com o método do cotovelo
wss <- (nrow(df_ACM)-1)*sum(apply(df_ACM, 2, var))
for (i in 2:10) wss[i] <- sum(kmeans(df_ACM, centers=i)$withinss)
# Plotar o gráfico do cotovelo
plot(1:10, wss, type="b", xlab="Número de Clusters", ylab="Soma dos Erros Quadrados")
# Após determinar o número ideal, aplicar o K-means
set.seed(123) # para reprodutibilidade
kmeans_result <- kmeans(coordenadas_ACM, centers=ideal_clusters)
# Plotar os resultados
plot(coordenadas_ACM, col=kmeans_result$cluster, pch=20, cex=2)
# Plotar os resultados
plot(df_ACM, col=kmeans_result$cluster, pch=20, cex=2)
colnames(df_ACM)
# Análise da variabilidade para determinar o número de clusters com o método do cotovelo
wss <- (nrow(df_ACM)-1)*sum(apply(df_ACM, 2, var))
for (i in 2:10) wss[i] <- sum(kmeans(df_ACM, centers=i)$withinss)
# Plotar o gráfico do cotovelo
plot(1:10, wss, type="b", xlab="Número de Clusters", ylab="Soma dos Erros Quadrados")
# --- 24/08
getwd()
dados_acm<- read.csv("data/perfil_eleitor_red.csv", sep = ",", header = TRUE, stringsAsFactors = TRUE)
# --- 24/08
getwd()
dados_acm<- read.csv("data/perfil_eleitor_red.csv", sep = ",", header = TRUE, stringsAsFactors = TRUE)
# Mostra as primeiras linhas do data frame
head(dados_acm)
# Mostra a estrutura do data frame
str(dados_acm)
# Padroniza os nomes (tudo maiúsculo)
names(dados_acm) <- toupper(names(dados_acm))
# Remove linhas com NA (caso existam)
dados_acm <- na.omit(dados_acm)
library('ggplot2')
# Carregando todos
if(sum(as.numeric(!pacotes %in% installed.packages())) != 0){
instalador <- pacotes[!pacotes %in% installed.packages()]
for(i in 1:length(instalador)) {
install.packages(instalador, dependencies = T)
break()}
sapply(pacotes, require, character = T)
} else {
sapply(pacotes, require, character = T)
}
library(ggplot2)
library(ggrepel)
# A função para a criação da ACM pede que sejam utilizados "fatores"
dados_acm <- as.data.frame(unclass(dados_acm), stringsAsFactors=TRUE)
# Instalação e carregamento dos pacotes utilizados
pacotes <- c("plotly",
"tidyverse",
"ggrepel",
"knitr", "kableExtra",
"sjPlot",
"FactoMineR",
"amap",
"ade4",
"readxl")
# Remove linhas com NA (caso existam)
dados_acm <- na.omit(dados_acm)
# Instalação e carregamento dos pacotes utilizados
pacotes <- c("plotly",
"tidyverse",
"ggrepel",
"ggplot2",
"knitr", "kableExtra",
"sjPlot",
"FactoMineR",
"amap",
"ade4",
"readxl")
# Carregando todos
if(sum(as.numeric(!pacotes %in% installed.packages())) != 0){
instalador <- pacotes[!pacotes %in% installed.packages()]
for(i in 1:length(instalador)) {
install.packages(instalador, dependencies = T)
break()}
sapply(pacotes, require, character = T)
} else {
sapply(pacotes, require, character = T)
}
# A função para a criação da ACM pede que sejam utilizados "fatores"
dados_acm <- as.data.frame(unclass(dados_acm), stringsAsFactors=TRUE)
# Tabelas de contingência (todas apresentam associação com alguma variável?)
sjt.xtab(var.row = dados_acm $DS_TIPO_DEFICIENCIA,
var.col = dados_acm $DS_GENERO,
show.exp = TRUE,
show.row.prc = TRUE,
show.col.prc = TRUE,
encoding = "UTF-8")
sjt.xtab(var.row = dados_acm $DS_TIPO_DEFICIENCIA,
var.col = dados_acm $DS_FAIXA_ETARIA,
show.exp = TRUE,
show.row.prc = TRUE,
show.col.prc = TRUE,
encoding = "UTF-8")
sjt.xtab(var.row = dados_acm $DS_TIPO_DEFICIENCIA,
var.col = dados_acm $DS_RACA_COR,
show.exp = TRUE,
show.row.prc = TRUE,
show.col.prc = TRUE,
encoding = "UTF-8")
sjt.xtab(var.row = dados_acm $DS_TIPO_DEFICIENCIA,
var.col = dados_acm $DS_GRAU_ESCOLARIDADE,
show.exp = TRUE,
show.row.prc = TRUE,
show.col.prc = TRUE,
encoding = "UTF-8")
sjt.xtab(var.row = dados_acm $DS_TIPO_DEFICIENCIA,
var.col = dados_acm $DS_ESTADO_CIVIL,
show.exp = TRUE,
show.row.prc = TRUE,
show.col.prc = TRUE,
encoding = "UTF-8")
sjt.xtab(var.row = dados_acm $DS_TIPO_DEFICIENCIA,
var.col = dados_acm $SG_UF,
show.exp = TRUE,
show.row.prc = TRUE,
show.col.prc = TRUE,
encoding = "UTF-8")
sjt.xtab(var.row = dados_acm $DS_TIPO_DEFICIENCIA,
var.col = dados_acm $REGIAO,
show.exp = TRUE,
show.row.prc = TRUE,
show.col.prc = TRUE,
encoding = "UTF-8")
# Vamos gerar a ACM
ACM <- dudi.acm(dados_acm, scannf = FALSE)
# Analisando as variâncias de cada dimensão (tirando os autovalores)
perc_variancia <- (ACM$eig / sum(ACM$eig)) * 100
paste0(round(perc_variancia,2),"%")
# Quantidade de categorias por variável
quant_categorias <- apply(dados_acm,
MARGIN =  2,
FUN = function(x) nlevels(as.factor(x)))
df_ACM <- data.frame(ACM$c1, Variável = rep(names(quant_categorias),
quant_categorias))
# Plotando o mapa perceptual
df_ACM %>%
rownames_to_column() %>%
rename(Categoria = 1) %>%
ggplot(aes(x = CS1, y = CS2, label = Categoria, color = Variável)) +
geom_point() +
geom_label_repel() +
geom_vline(aes(xintercept = 0), linetype = "longdash", color = "grey48") +
geom_hline(aes(yintercept = 0), linetype = "longdash", color = "grey48") +
labs(x = paste("Dimensão 1:", paste0(round(perc_variancia[1], 2), "%")),
y = paste("Dimensão 2:", paste0(round(perc_variancia[2], 2), "%"))) +
theme_bw()
ggsave("output/mapa_acm_perfil.png", grafico_acm, width = 10, height = 8, dpi = 300)
ggsave("output/mapa_acm_perfil.png", df_acm, width = 10, height = 8, dpi = 300)
ggsave("output/mapa_acm_perfil.png", df_ACM, width = 10, height = 8, dpi = 300)
# Plotando o mapa perceptual
grafico_acm <- df_ACM %>%
rownames_to_column() %>%
rename(Categoria = 1) %>%
ggplot(aes(x = CS1, y = CS2, label = Categoria, color = Variável)) +
geom_point() +
geom_label_repel() +
geom_vline(aes(xintercept = 0), linetype = "longdash", color = "grey48") +
geom_hline(aes(yintercept = 0), linetype = "longdash", color = "grey48") +
labs(
title = "Mapa Perceptual - Análise de Correspondência Múltipla",
x = paste("Dimensão 1:", paste0(round(perc_variancia[1], 2), "%")),
y = paste("Dimensão 2:", paste0(round(perc_variancia[2], 2), "%"))
) +
theme_bw()
str(grafico_acm)
print(grafico_acm)
ggsave("output/mapa_acm_perfil.png", grafico_acm, width = 10, height = 8, dpi = 300)
# Exemplo de como destacar variáveis específicas no ggplot (como tipos de deficiência)
library(ggplot2)
colnames(df_ACM)
# Análise da variabilidade para determinar o número de clusters com o método do cotovelo
wss <- (nrow(df_ACM)-1)*sum(apply(df_ACM, 2, var))
git remote add origin https://github.com/Cibelly09/An-lise-de-Correla-o-M-ltipla.git
git remote add origin https://github.com/Cibelly09/An-lise-de-Correla-o-M-ltipla.git
for (i in 2:10) wss[i] <- sum(kmeans(df_ACM, centers=i)$withinss)
# Plotar o gráfico do cotovelo
plot(1:10, wss, type="b", xlab="Número de Clusters", ylab="Soma dos Erros Quadrados")
